<!doctype html>
<html>
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable"  content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no">
    
    
    <!--Simple SEO-->

<meta name="description" content=My Shelter/>


<meta name="robots" content=all />
<meta name="google" content=all />
<meta name="googlebot" content=all />
<meta name="verify" content=all />
    <!--Title-->

<title>Cordova Plugin 만들기 #2 | 개발 블로그</title>

<link rel="alternate" href="/atom.xml" title="개발 블로그" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/pages/post.css">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/thirdParty/highlight/github.css">

    <!--script-->



<!--<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>-->


    
    
<!-- old source
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', '', 'auto');
    ga('send', 'pageview');

</script>
-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111716055-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111716055-1');
</script>


</head>

<body id="normal">
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<style>
    header{ top: 71px; position: absolute!important;}
    #container{padding-top: 151px!important;}
</style>
<div style="position:fixed;z-index:9999;left:0;top:0;width:100%;height:70px;background-color:#e0e0e0;color:#396CA5;border-bottom:1px solid #cecece;text-align:center;line-height:70px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis">귀하의 브라우저 버전이 너무 낮습니다. 더 나은 사용환경을 경험하시려면 브라우저 버전을 업데이트 하시거나 IE Edge, Chrome, Firefox, Safari 등과 같은 최신 브라우저를 사용하십시오</div>
<![endif]-->

<div id="wrap">
    <header  style="position: absolute;" >
    <div id="site-meta">
        <a href="/" id="logo">
            <h1 class="title">개발 블로그</h1>
        </a>
        
        <h2 class="subtitle">Blah Blah</h2>
        
    </div>
    <ul id="nav">
        
            <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
        
            <li><a href="/about"><i class="fa fa-user"></i>About</a></li>
        
            <li><a href="/atom.xml"><i class="fa fa-rss"></i>RSS</a></li>
        
        <li id="search"><a href="javascript:void(0)"><i class="fa fa-search"></i>검색</a></li>
    </ul>
</header>

    <div id="container">
        
<ul id="sidebar">
    
    
<li class="widget notification">
    <i class="fa fa-bell-o"></i>
    <div>
        <p>블로그 공지<br>
ylion 한국어 지원：<a href="https://github.com/henotia" title="github" target="_blank">Henotia</a>
</p>
    </div>
</li>

    
    
<li class="widget widget-normal category">
    <h3 class="fa fa-th widget-title">카테고리</h3>
    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Ionic/"><i class="fa" aria-hidden="true">Ionic</i></a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/계획/"><i class="fa" aria-hidden="true">계획</i></a><span class="category-list-count">1</span></li></ul>
</li>


    
    
<li class="widget widget-normal archive">
  <h3 class="fa fa-archive widget-title">Archives</h3>
    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/"><i class="fa" aria-hidden="true">1월 2018</i></a><span class="archive-list-count">6</span></li></ul>
</li>


    
    
<li class="widget widget-normal tags">
  <h3 class="fa fa-tags widget-title">태그</h3>
  <div class="tagcloud-content">
    
      <a href="/tags/Ionic/" style="font-size: 0.18rem; color: #295e97">Ionic</a> <a href="/tags/Cordova/" style="font-size: 0.2rem; color: #0a407c">Cordova</a> <a href="/tags/Android/" style="font-size: 0.17rem; color: #477bb1">Android</a> <a href="/tags/Plugin/" style="font-size: 0.17rem; color: #477bb1">Plugin</a> <a href="/tags/신년계획/" style="font-size: 0.15rem; color: #69c">신년계획</a>
  </div>
</li>


    
    
<li class="widget widget-normal friends-link">
    <h3 class="fa fa-globe widget-title">링크</h3><br/>

    
        <a href="http://geekaholiclin.github.io" class="fa" target="_blank">테마 제작자</a>

    
        <a href="http://henotia.github.io" class="fa" target="_blank">한국어 번역</a>

    

</li>

    
</ul>


        <div id="main">
    <article id="post">
        <div id="post-header">

            <h1 id="Cordova Plugin 만들기 #2">
                
                Cordova Plugin 만들기 #2
                
            </h1>
            <div class="article-meta">
    
    
    <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
        <span>Ionic</span>
    </span>
    
    
    <span class="fa-wrap">
         <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            Cordova
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta ">2018/01/31</span>
    </span>
    
    
    
</div>

            
            
        </div>
        
        <div id="post-body">
            <blockquote>
<p><strong>본 post에서는 Cordova Plugin 작성에 대해 설명합니다</strong><br><strong>본 post의 내용은 <a href="/MakeCordovaPlugin-1">Cordova Plugin 만들기 #1</a>에서 이어집니다</strong></p>
</blockquote>
<hr>
<h2 id="Plugin-Structure"><a href="#Plugin-Structure" class="headerlink" title="Plugin Structure"></a>Plugin Structure</h2><p>Cordova Plugin을 이루고 있는 골자는 크게 다음과 같다.</p>
<ol>
<li>사용하고자 하는 Native 기능이 담긴 <code>Native Interface</code></li>
<li><code>cordova.exec</code>를 통해 Native platform과 통신하는 <code>Javascript Interface</code></li>
<li>플러그인의 명세가 담긴 <code>config</code>파일</li>
</ol>
<p><img src="0.zdjr5962sa.png" alt="0.zdjr5962sa"></p>
<p>이후 위의 내용을 바탕으로 사용자에게 텍스트를 입력받아 그대로 출력하는 <code>Echo</code> 플러그인을 작성해본다.</p>
<h2 id="Native-Interface"><a href="#Native-Interface" class="headerlink" title="Native Interface"></a>Native Interface</h2><p>Cordova Project에서 사용하는 Native 기능을 작성한다.</p>
<p>본 파일은 CordovaPlugin을 extend하는 자바 클래스로서, CordovaPlugin으로부터 메소드를 Override 받아 필요한 기능을 작성한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.cordova.CordovaPlugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">myPlugin</span> <span class="keyword">extends</span> <span class="title">CordovaPlugin</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="생명주기"><a href="#생명주기" class="headerlink" title="생명주기"></a>생명주기</h3><p><code>myPlugin</code> 플러그인 객체는 Cordova Webview의 수명을 따른다.<br>기본적으로 플러그인 객체는 JavaScript의 호출 시점에 인스턴스화 되며, <code>plugin.xml</code>에서 별도의 옵션을 주면 시작과 동시에 인스턴스화 시킬 수 있다.</p>
<h3 id="플러그인-작성"><a href="#플러그인-작성" class="headerlink" title="플러그인 작성"></a>플러그인 작성</h3><p><code>JavaScript Interface</code>에서 플러그인 호출이 일어나면 <code>Native Interface</code>의 <code>execute</code> 메소드로 전달이 된다.<br>execute 메소드는 CordovaPlugin에서 Override를 받아 작성하며, 다음과 같이 작성할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.myplugin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.cordova.CallbackContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.cordova.CordovaPlugin;</span><br><span class="line"><span class="keyword">import</span> org.json.JSONArray;</span><br><span class="line"><span class="keyword">import</span> org.json.JSONException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">myPlugin</span> <span class="keyword">extends</span> <span class="title">CordovaPlugin</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">execute</span><span class="params">(String action, JSONArray args, CallbackContext callbackContext)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// plugin.xml에 맵핑되어있는 action과 JavaScript Interface에서 전달받는 action이 동일할 때 수행한다</span></span><br><span class="line">    <span class="keyword">if</span> (action.equals(<span class="string">"echo"</span>)) &#123;</span><br><span class="line">      <span class="comment">// JavaScript Interface에서 전달받은 매개변수를 받아 저장한다</span></span><br><span class="line">      String message = args.getString(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// JavaScript Interface로 보낼 Callback 함수</span></span><br><span class="line">      <span class="keyword">if</span> (message != <span class="keyword">null</span> &amp;&amp; message.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        callbackContext.success(message);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callbackContext.error(<span class="string">"Echo Fail"</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>플러그인 코드 작성이 끝났으면 이를 <code>plugin.xml</code>에 <code>Native Interface</code>에 대한 명세를 작성한다</p>
<h2 id="Plugin-명세-작성"><a href="#Plugin-명세-작성" class="headerlink" title="Plugin 명세 작성"></a>Plugin 명세 작성</h2><p>Plugin에 대한 명세는 Plugin 폴더 상단에 위치한 <code>plugin.xml</code>(파일 명이 다를 수 있음)에 작성한다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">id</span>=<span class="string">"com.test.myplugin"</span> <span class="attr">version</span>=<span class="string">"0.0.1"</span> <span class="attr">xmlns</span>=<span class="string">"http://apache.org/cordova/ns/plugins/1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>myPlugin<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- src에는 JavaScript Interface 파일이 위치한 곳을 기입한다 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">js-module</span> <span class="attr">name</span>=<span class="string">"myPlugin"</span> <span class="attr">src</span>=<span class="string">"www/myPlugin.js"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- clobbers에 target으로 작성된 부분이 추후 JavaScript로 호출시 사용된다 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- target은 window에 객체로 등록되며, 아래의 경우는 window.cordova.plugins.myPlugin으로 호출 할 수 있다--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">clobbers</span> <span class="attr">target</span>=<span class="string">"cordova.plugins.myPlugin"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">js-module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- platform 별 명세를 작성한다 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">"android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">config-file</span> <span class="attr">parent</span>=<span class="string">"/*"</span> <span class="attr">target</span>=<span class="string">"res/xml/config.xml"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">feature</span> <span class="attr">name</span>=<span class="string">"myPlugin"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- value에는 작성한 플러그인이 위치할 곳의 package와 class명을 적어준다 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"android-package"</span> <span class="attr">value</span>=<span class="string">"com.test.myplugin.myPlugin"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">feature</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">config-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">config-file</span> <span class="attr">parent</span>=<span class="string">"/*"</span> <span class="attr">target</span>=<span class="string">"AndroidManifest.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">config-file</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- source-file의 src에 위치한 파일을 build시 target-dir의 위치에 저장한다 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source-file</span> <span class="attr">src</span>=<span class="string">"src/android/myPlugin.java"</span> <span class="attr">target-dir</span>=<span class="string">"src/com/test/myplugin"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>명세를 작성한 다음에는 <code>JavaScript Interface</code>를 수정해</p>
<h2 id="JavaScript-Interface"><a href="#JavaScript-Interface" class="headerlink" title="JavaScript Interface"></a>JavaScript Interface</h2><p>JavaScript로 Native Interface를 호출 할 수 있도록 JavaScript Interface를 수정해준다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> exec = <span class="built_in">require</span>(<span class="string">'cordova/exec'</span>);</span><br><span class="line"></span><br><span class="line">exports.echo = <span class="function"><span class="keyword">function</span>(<span class="params">args, success, error</span>) </span>&#123;</span><br><span class="line">    exec(success, error, <span class="string">"myPlugin"</span>, <span class="string">"echo"</span>, [args]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>exec</code>는 platform 추가시 <code>platform_www/cordova.js</code>에 위치한다.<br>JavaScript Interface를 좀 더 전문적으로 사용하기 위해서는 확인이 필요하지만 본 포스트에서는 넘어가도록 한다.</p>
<p><code>exports.echo</code> 를 통해 등록한 함수를 JavaScript로 호출할 수 있다.<br>함수 내부의 exec는 총 다섯가지의 매개변수를 갖는다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">Arguments, SuccessCallback, ErrorCallback</span>) </span>&#123;</span><br><span class="line">  exec(SuccessCallback, ErrorCallback, <span class="string">"FeatureName"</span>, <span class="string">"ActionName"</span>, [Arguments])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>SuccessCallback: <code>Native Interface</code>에서 <code>callbackContext.success</code>를 통해 전달받는 콜백함수</li>
<li>ErrorCallback: <code>Native Interface</code>에서 <code>callbackContext.error</code>를 통해 전달받는 콜백함수</li>
<li>“FeatureName”: <code>config</code>파일 내에 <code>&lt;feature name=&quot;&quot; &gt;</code>에서 사용되는 name을 기입한다</li>
<li>“ActionName”: <code>Native Interface</code>에서 <code>execute</code>메소드에서 전달받아 사용할 Action 명을 기입한다</li>
<li>[Arguments]: <code>Native Interface</code>로 보낼 매개변수 (반드시 배열로 보내야 함)</li>
</ul>
<p>위의 매개변수를 바탕으로 <code>JavaScript Interface</code>에서 <code>Native Interface</code>로 매개변수와 호출할 함수를 전달한다.</p>
<h2 id="package-json-작성"><a href="#package-json-작성" class="headerlink" title="package.json 작성"></a>package.json 작성</h2><p>플러그인 작성이 끝났으면 plugin에서 사용할 package.json을 작성해 주어야 한다<br>이전 포스트에서 사용했던 <code>plugman</code> 모듈을 사용해 package.json을 작성해 줄 수 있다.</p>
<p><code>myPlugin</code> 디렉토리에서 아래와 같은 명령어를 사용한다</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ plugman createpackagejson . <span class="comment"># .을 반드시 써주어야 한다</span></span><br></pre></td></tr></table></figure>
<p>이후 나오는 내용을 본인에게 맞게 수정해주면 된다.</p>
<p><img src="0.wxaoyebsm3c.png" alt="0.wxaoyebsm3c"><br>예시에서는 별다른 수정없이 엔터만을 쳐서 넘겼다.</p>
<h2 id="플러그인-설치"><a href="#플러그인-설치" class="headerlink" title="플러그인 설치"></a>플러그인 설치</h2><p>위의 내용을 잘 따라왔다면 프로젝트 디렉토리는 다음과 같을 것이다.</p>
<p><img src="0.i8yaeifavc9.png" alt="0.i8yaeifavc9"></p>
<p>이후 Android Platform을 설치해준다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova platform add android</span><br></pre></td></tr></table></figure>
<p>platform이 추가되었으면 다음의 명령어를 통해 <code>myPlugin</code>을 설치해준다</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova plugin add myPlugin --link</span><br></pre></td></tr></table></figure>
<p>명령어 실행 후 <code>plugins</code>디렉토리 아래에 <code>com.test.myplugin</code>으로 디렉토리가 하나 생기고 그 안에 우리가 작성한 <code>myPlugin</code>의 내용이 담겨있다<br><code>plugin.xml</code>의 <code>&lt;plugin id=&quot;&quot;&gt;</code>의 값이 디렉토리의 이름으로 지정이 된다.<br>따라서 이름을 바꾸고 싶으면 위의 부분을 바꾸어 주면 된다.</p>
<p><img src="0.5tqssi4ezat.png" alt="0.5tqssi4ezat"></p>
<p>마찬가지로 아래의 사진에서 <code>plugin.xml</code>의 <code>&lt;source-file src=&quot;&quot; target-dir=&quot;&quot;&gt;</code>에서 target-dir의 값이 platform 내에 들어간 것을 확인 할 수 있다<br><img src="0.6enw08uhwaj.png" alt="0.6enw08uhwaj"></p>
<h2 id="플러그인-실행"><a href="#플러그인-실행" class="headerlink" title="플러그인 실행"></a>플러그인 실행</h2><p>플러그인 설치까지 완료 되었으면, 실제 Cordova App에서 플러그인이 정상적으로 작동하는지 테스트 해보자</p>
<h3 id="플러그인-호출-코드-작성"><a href="#플러그인-호출-코드-작성" class="headerlink" title="플러그인 호출 코드 작성"></a>플러그인 호출 코드 작성</h3><p>프로젝트 루트 내에 있는 <code>www/</code>아래의 <code>index.html</code>을 다음과 같이 수정해준다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~~~</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Apache Cordova<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"deviceready"</span> <span class="attr">class</span>=<span class="string">"blink"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"event listening"</span>&gt;</span>Connecting to Device<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"event received"</span>&gt;</span>Device is Ready<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"echo"</span> <span class="attr">placeholder</span>=<span class="string">"Echo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"send"</span>&gt;</span>전송<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">~~~</span><br></pre></td></tr></table></figure>
<p>이어서 <code>www/</code>아래의 <code>js/index.js</code>에 아래의 내용을 추가해준다<br><code>button#send</code>를 클릭하면 input의 값을 plugin으로 보내고, callback받은 값을 alert으로 띄우는 코드이다<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~~~</span><br><span class="line"></span><br><span class="line">app.initialize();</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'send'</span>).addEventListener(<span class="string">'click'</span>, sendInput);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendInput</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> input = <span class="built_in">document</span>.getElementById(<span class="string">'echo'</span>).value,</span><br><span class="line">        success = <span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123; alert(v); &#125;,</span><br><span class="line">        error = <span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123; alert(v); &#125;;</span><br><span class="line"></span><br><span class="line">    cordova.plugins.myPlugin.echo(input, success, error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="테스트"><a href="#테스트" class="headerlink" title="테스트"></a>테스트</h3><p>작성이 모두 끝났으면 device를 pc에 연결하고 cordova project를 실행한다</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cordova run android</span><br></pre></td></tr></table></figure>
<p>정상적으로 실행이 되면 기기에서 수정된 html을 확인 할 수 있다<br><img src="0.upajtrhcqp.png" width="300"></p>
<p>Input창에 임의의 텍스르를 입력하고 전송을 누르면 Native Interface를 거쳐 callback으로 받아와 화면에 보여준다<br><img src="0.c0rkuz5eovu.png" width="300"></p>
<p>정상적으로 플러그인이 연결된 것을 확인 할 수 있다.</p>
<hr>
<h2 id="플러그인-삭제"><a href="#플러그인-삭제" class="headerlink" title="플러그인 삭제"></a>플러그인 삭제</h2><blockquote>
<p>본 섹션에서 설명하는 내용은 여지껏 작업한 <code>myPlugin</code> 프로젝트를 바탕으로 설명합니다</p>
</blockquote>
<p>플러그인 개발을 하다보면 설치, 수정, 삭제 등 다양한 시도를 해보게 된다.<br>하지만 설치된 플러그인을 제대로 지우지 않는 경우 복잡하게 꼬여 문제가 될 수 있다.<br>이 번외 섹션에서는 플러그인을 삭제할 경우 어느부분을 어떻게 지워야 하는지에 대해 설명한다.</p>
<h3 id="Cordova-명령어-사용"><a href="#Cordova-명령어-사용" class="headerlink" title="Cordova 명령어 사용"></a>Cordova 명령어 사용</h3><p>Cordova-CLI에서는 plugin을 지우는 <code>cordova plugin rm &lt;plugin_id&gt;</code> 명령어를 제공한다.<br>해당 명령어로 플러그인을 지우기 위해서는 우선 플러그인의 ID가 필요하다.<br>플러그인의 ID는 <code>cordova plugin ls</code>로 확인이 가능하다.</p>
<p><img src="0.ery5nr8fyrm.png" alt="0.ery5nr8fyrm"></p>
<p>위의 내용을 바탕으로 <code>com.test.myplugin</code> 플러그인을 지우면 다음과 같은 문제가 생긴다</p>
<p><img src="0.t0xml3cttyj.png" alt="0.t0xml3cttyj"></p>
<p><code>com.test.myplugin</code>의 <code>myPlugin</code>버전을 찾을수 없다는 내용인데 package.json을 확인해보면<br><img src="0.zfp86y9rfbf.png" alt="0.zfp86y9rfbf"></p>
<p><code>com.test.myplugin</code>의 버전이 <code>myPlugin</code>의 형태로 되어있는 것을 확인할 수 있다.<br>위의 명령어 실행이후로, 추가적인 삭제가 필요한 부분을 하나씩 찾아나가자</p>
<h3 id="프로젝트-내부"><a href="#프로젝트-내부" class="headerlink" title="프로젝트 내부"></a>프로젝트 내부</h3><p>프로젝트 내부에서 설치된 플러그인은 아래의 위치에 각각 저장이 된다</p>
<ul>
<li>node_module<br><img src="0.p9qaih3axc.png" alt="0.p9qaih3axc"></li>
<li>plugins/fetch.json<br><img src="0.fhptplthk28.png" alt="0.fhptplthk28"></li>
<li>config.xml<br><img src="0.ii7j6ka82l.png" alt="0.ii7j6ka82l"></li>
<li>package.json<br><img src="0.yctaadvv1l.png" alt="0.yctaadvv1l"></li>
</ul>
<p>위의 내용들을 전부 지워주면 된다.</p>
<ul>
<li>node_module<br>단순히 삭제만 해주면 된다</li>
<li><p>plugins/fetch.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>config.xml<br><code>&lt;plugin name=&quot;com.test.myplugin&quot; spec=&quot;myPlugin&quot; /&gt;</code>을 지워준다</p>
</li>
<li>package.json<br>cordova-plugins와 dependencies에 작성된 부분을 지워준다</li>
</ul>
<h3 id="프로젝트-외부"><a href="#프로젝트-외부" class="headerlink" title="프로젝트 외부"></a>프로젝트 외부</h3><p><code>cordova plugin add --link</code>를 통해 설치한 플러그인은 npm 전역에도 설치가 된다</p>
<p>윈도우 기준으로<br><code>%appdata%/npm/node_modules</code>로 들어가서<br><img src="0.c8p1gwvmmxw.png" alt="0.c8p1gwvmmxw"><br>본인이 설치한 플러그인에 해당 되는 부분을 삭제해준다.</p>
<hr>
<p>Cordova Plugin 만드는 기본적인 방법에 대해 설명했다.</p>
<p>본 포스트에서는 수정을 최소화 하고 동작에 중점을 두고 작업했기에 이름이나 ID 등이 마음에 들지 않을 수 있다.</p>
<p>그 부분을 수정하고 적용해 보는건 본인의 몫으로 남긴다.</p>

        </div>
        <div id="post-footer">
            <div class="avatar" >
                <img src="/img/avatar.jpg" alt="avatar"/>
                
                
            </div>
            <ul class="author-profile-section">
                <li>
                  
                  글쓴이:
                  
                    
                    <a href="/about.html">Henotia</a>
                </li>
                
                <li>발행 일자: <span>2018-01-31  11:07:05</span></li>
                
                <li>업데이트 일자: <span>2018-01-31  13:12:18</span></li>
                
                <li class="post-category">
                    카테고리:
                    
                    <a href="/categories/Ionic/">Ionic</a>
                    
                </li>
                <li class="post-tags">
                    태그:
                    
                    <a href="/tags/Cordova/">Cordova</a>
                    
                    <a href="/tags/Android/">Android</a>
                    
                    <a href="/tags/Plugin/">Plugin</a>
                    
                </li>
                
                <li> License: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="크리에이티브 커먼즈 CC BY-NC-SA 4.0 라이센스">
<img src="https://licensebuttons.net/l/by-nc-sa/4.0/80x15.png" style="vertical-align:middle">
저작자표시-비영리-동일조건변경허락 (CC BY-NC-SA 4.0）
</a></li>
                
            </ul>

            
        </div>
    </article>
    <div class="article-nav">
        
        
        <a href="/MakeCordovaPlugin-1/" class="next-post fa">Cordova Plugin 만들기 #1</a>
        
    </div>
    
    <div id="comments">
        

<div id="disqus_thread"></div>
<script>
    var shortName = 'henotia-github-io-1'

    var disqus_config = function () {
     this.page.url = 'http://henotia.github.io/MakeCordovaPlugin-2/';  // Replace PAGE_URL with your page's canonical URL variable
     this.page.identifier = 'post'+'-MakeCordovaPlugin-2/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
     };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//'+shortName+'.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<script id="dsq-count-scr" src="//henotia-github-io-1.disqus.com/count.js" async></script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




    </div>
    
</div>


    </div>
    <footer id="footer">
    
    <div class="social">
        
        <a href="https://github.com/henotia" class="fa fa-github" target="_blank" title="Follow me~"></a>
        
    </div>
    
    <div>
        
        <a href="/" class="copyright-links">Henotia</a>&copy;2018 - 2018.All Rights
        Reserved.
    </div>
    <p>Powered by <a href="https://hexo.io" class="copyright-links" target="_blank">Hexo</a> | Theme by <a
                href="https://github.com/GeekaholicLin" class="copyright-links" target="_blank">GeekaholicLin</a>
    </p>
    
</footer>

</div>
    <ul id="tools">
    <li class="totop-btn fa fa-angle-up"></li>
    <li class="exchange-btn fa fa-exchange"></li>
  
    <li class="toc-btn fa fa-list-ul"></li>
    
    

    
    <li class="comment-btn fa fa-comments-o">
        <a href="#comments" title="comments"></a>
    </li>
    
</ul>
<p id="process"></p>
<div id="search-overlay">
    <div class="search-area-wrap">
        <div id="search-area">
            <div class="input-wrap focus">
                <i class="fa fa-search" aria-hidden="true"></i>
                <input id="search-input" autofocus autocomplete="off" type="text"
                       placeholder="search this website..."/>
            </div>
            <ul id="search-result">
                <li class="load-first"><i class="fa fa-spinner fa-pulse"></i></li>
            </ul>
        </div>
    </div>
</div>

    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Plugin-Structure"><span class="toc-number">1.</span> <span class="toc-text"><a href="#Plugin-Structure" class="headerlink" title="Plugin Structure"></a>Plugin Structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Native-Interface"><span class="toc-number">2.</span> <span class="toc-text"><a href="#Native-Interface" class="headerlink" title="Native Interface"></a>Native Interface</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#생명주기"><span class="toc-number">2.1.</span> <span class="toc-text"><a href="#&#xC0DD;&#xBA85;&#xC8FC;&#xAE30;" class="headerlink" title="&#xC0DD;&#xBA85;&#xC8FC;&#xAE30;"></a>&#xC0DD;&#xBA85;&#xC8FC;&#xAE30;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#플러그인-작성"><span class="toc-number">2.2.</span> <span class="toc-text"><a href="#&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xC791;&#xC131;" class="headerlink" title="&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC791;&#xC131;"></a>&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC791;&#xC131;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Plugin-명세-작성"><span class="toc-number">3.</span> <span class="toc-text"><a href="#Plugin-&#xBA85;&#xC138;-&#xC791;&#xC131;" class="headerlink" title="Plugin &#xBA85;&#xC138; &#xC791;&#xC131;"></a>Plugin &#xBA85;&#xC138; &#xC791;&#xC131;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript-Interface"><span class="toc-number">4.</span> <span class="toc-text"><a href="#JavaScript-Interface" class="headerlink" title="JavaScript Interface"></a>JavaScript Interface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#package-json-작성"><span class="toc-number">5.</span> <span class="toc-text"><a href="#package-json-&#xC791;&#xC131;" class="headerlink" title="package.json &#xC791;&#xC131;"></a>package.json &#xC791;&#xC131;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#플러그인-설치"><span class="toc-number">6.</span> <span class="toc-text"><a href="#&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xC124;&#xCE58;" class="headerlink" title="&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC124;&#xCE58;"></a>&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC124;&#xCE58;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#플러그인-실행"><span class="toc-number">7.</span> <span class="toc-text"><a href="#&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xC2E4;&#xD589;" class="headerlink" title="&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC2E4;&#xD589;"></a>&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC2E4;&#xD589;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#플러그인-호출-코드-작성"><span class="toc-number">7.1.</span> <span class="toc-text"><a href="#&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xD638;&#xCD9C;-&#xCF54;&#xB4DC;-&#xC791;&#xC131;" class="headerlink" title="&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xD638;&#xCD9C; &#xCF54;&#xB4DC; &#xC791;&#xC131;"></a>&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xD638;&#xCD9C; &#xCF54;&#xB4DC; &#xC791;&#xC131;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#테스트"><span class="toc-number">7.2.</span> <span class="toc-text"><a href="#&#xD14C;&#xC2A4;&#xD2B8;" class="headerlink" title="&#xD14C;&#xC2A4;&#xD2B8;"></a>&#xD14C;&#xC2A4;&#xD2B8;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#플러그인-삭제"><span class="toc-number">8.</span> <span class="toc-text"><a href="#&#xD50C;&#xB7EC;&#xADF8;&#xC778;-&#xC0AD;&#xC81C;" class="headerlink" title="&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC0AD;&#xC81C;"></a>&#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC0AD;&#xC81C;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cordova-명령어-사용"><span class="toc-number">8.1.</span> <span class="toc-text"><a href="#Cordova-&#xBA85;&#xB839;&#xC5B4;-&#xC0AC;&#xC6A9;" class="headerlink" title="Cordova &#xBA85;&#xB839;&#xC5B4; &#xC0AC;&#xC6A9;"></a>Cordova &#xBA85;&#xB839;&#xC5B4; &#xC0AC;&#xC6A9;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#프로젝트-내부"><span class="toc-number">8.2.</span> <span class="toc-text"><a href="#&#xD504;&#xB85C;&#xC81D;&#xD2B8;-&#xB0B4;&#xBD80;" class="headerlink" title="&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xB0B4;&#xBD80;"></a>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xB0B4;&#xBD80;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#프로젝트-외부"><span class="toc-number">8.3.</span> <span class="toc-text"><a href="#&#xD504;&#xB85C;&#xC81D;&#xD2B8;-&#xC678;&#xBD80;" class="headerlink" title="&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xC678;&#xBD80;"></a>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xC678;&#xBD80;</span></a></li></ol></li></ol>




<script src="/js/search.js"></script>
<script type="text/javascript">
    //theme config datas
    var copyrightObj = {};
    copyrightObj.enable = 'true';
    copyrightObj.triggerCopyLength = '200';
    copyrightObj.appendText = '상업적인 사용은 저자에게 연락하여 권한을 얻어주시기 바랍니다. 비상업적 사용은 출처를 명확히 밝혀주시기 바랍니다 ©';
    var leancloudObj = {};
    leancloudObj.enable = 'false';
    leancloudObj.className = 'BlogCounter';
    leancloudObj.limits = '10';
</script>
<script type="text/javascript">
    var search = {};
    var search_path = "search.xml";
    if (!search_path) {
        search_path = "search.xml";
    }
    search.path = "/" + search_path;
    search.func =  _ajax.init();
</script>
<script src="/js/app.js"></script>


</body>
</html>